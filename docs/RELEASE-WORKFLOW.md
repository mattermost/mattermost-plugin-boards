# Release Workflow Documentation

## ๐ ะัะพัะตัั ัะตะปะธะทะฐ

### ะะฒัะพะผะฐัะธัะตัะบะธะน ัะตะปะธะท ัะตัะตะท GitHub Actions

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    RELEASE WORKFLOW                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. ะะฐะทัะฐะฑะพััะธะบ                    2. GitHub Actions
   โโโโโโโโโโโโ                      โโโโโโโโโโโโ
   โ ะะฑะฝะพะฒะธัั โ                      โ Checkout โ
   โ version  โ                      โ   ะบะพะด    โ
   โ ะฒ plugin โ                      โโโโโโฌโโโโโโ
   โ  .json   โ                           โ
   โโโโโโฌโโโโโโ                           โ
        โ                                 โ
        โ                            โโโโโโผโโโโโโ
   โโโโโโผโโโโโโ                      โ ะะทะฒะปะตัั  โ
   โ  Commit  โ                      โ  ะฒะตััะธั  โ
   โ ะธะทะผะตะฝะตะฝะธะนโ                      โะธะท plugin โ
   โโโโโโฌโโโโโโ                      โ  .json   โ
        โ                            โโโโโโฌโโโโโโ
        โ                                 โ
   โโโโโโผโโโโโโ                      โโโโโโผโโโโโโ
   โ   Push   โ                      โ ะกะพะฑัะฐัั  โ
   โ    ะฒ     โโโโโโโโโโโโโโโโโโโโโโโถโ  ะฟะปะฐะณะธะฝ  โ
   โ release  โ                      โ  Linux   โ
   โ  branch  โ                      โ  AMD64   โ
   โโโโโโโโโโโโ                      โโโโโโฌโโโโโโ
                                          โ
                                     โโโโโโผโโโโโโ
                                     โ ะกะพะทะดะฐัั  โ
                                     โ   tag    โ
                                     โv{version}โ
                                     โโโโโโฌโโโโโโ
                                          โ
                                     โโโโโโผโโโโโโ
                                     โ ะกะพะทะดะฐัั  โ
                                     โ  GitHub  โ
                                     โ Release  โ
                                     โโโโโโฌโโโโโโ
                                          โ
                                     โโโโโโผโโโโโโ
                                     โ ะะฐะณััะทะธััโ
                                     โ  .tar.gz โ
                                     โ ะฐััะตัะฐะบั โ
                                     โโโโโโโโโโโโ

3. ะะดะผะธะฝะธัััะฐัะพั ัะตัะฒะตัะฐ
   โโโโโโโโโโโโ
   โ ะกะบะฐัะฐัั  โ
   โ  ัะตะปะธะท   โ
   โ ั GitHub โ
   โโโโโโฌโโโโโโ
        โ
   โโโโโโผโโโโโโ
   โะฃััะฐะฝะพะฒะธััโ
   โ  ะฟะปะฐะณะธะฝ  โ
   โ    ะฝะฐ    โ
   โ  ัะตัะฒะตั  โ
   โโโโโโโโโโโโ
```

---

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ ัะตะปะธะทะฐ

```
mattermost-plugin-boards/
โโโ .github/
โ   โโโ workflows/
โ       โโโ ci.yml              # CI ัะตััั
โ       โโโ release.yml         # ะะฒัะพะผะฐัะธัะตัะบะธะน ัะตะปะธะท โญ
โโโ scripts/
โ   โโโ build-release.sh        # ะะพะบะฐะปัะฝะฐั ัะฑะพัะบะฐ (Linux/macOS)
โ   โโโ build-release.ps1       # ะะพะบะฐะปัะฝะฐั ัะฑะพัะบะฐ (Windows)
โ   โโโ update-plugin-on-server.sh  # ะะฒัะพะพะฑะฝะพะฒะปะตะฝะธะต ะฝะฐ ัะตัะฒะตัะต
โ   โโโ README.md               # ะะพะบัะผะตะฝัะฐัะธั ัะบัะธะฟัะพะฒ
โโโ docs/
โ   โโโ RELEASE-WORKFLOW.md     # ะญัะพั ัะฐะนะป
โโโ plugin.json                 # ะะตััะธั ะฟะปะฐะณะธะฝะฐ โญ
โโโ RELEASE.md                  # ะะพะปะฝะฐั ะธะฝััััะบัะธั
โโโ QUICKSTART-RELEASE.md       # ะัััััะน ััะฐัั
โโโ .env.example                # ะัะธะผะตั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
โโโ Makefile                    # ะฆะตะปะธ ัะฑะพัะบะธ
```

---

## ๐ฏ ะะปััะตะฒัะต ะบะพะผะฟะพะฝะตะฝัั

### 1. plugin.json
ะกะพะดะตัะถะธั ะฒะตััะธั ะฟะปะฐะณะธะฝะฐ, ะบะพัะพัะฐั ะธัะฟะพะปัะทัะตััั ะดะปั:
- ะกะพะทะดะฐะฝะธั ัะตะณะฐ ัะตะปะธะทะฐ
- ะะผะตะฝะพะฒะฐะฝะธั ัะฐะนะปะฐ ะฐััะตัะฐะบัะฐ
- ะัะพะฑัะฐะถะตะฝะธั ะฒ Mattermost

```json
{
  "version": "9.2.3",
  ...
}
```

### 2. .github/workflows/release.yml
GitHub Actions workflow, ะบะพัะพััะน:
- ะขัะธะณะณะตัะธััั ะฟัะธ push ะฒ ะฒะตัะบั `release`
- ะะทะฒะปะตะบะฐะตั ะฒะตััะธั ะธะท `plugin.json`
- ะกะพะฑะธัะฐะตั ะฟะปะฐะณะธะฝ ะดะปั Linux AMD64
- ะกะพะทะดะฐะตั GitHub Release
- ะะฐะณััะถะฐะตั ะฐััะตัะฐะบั

### 3. Makefile
ะกะพะดะตัะถะธั ัะตะปะธ ะดะปั ัะฑะพัะบะธ:
- `make dist-linux` - ัะฑะพัะบะฐ ะดะปั Linux
- `make trigger-release` - ะทะฐะฟััะบ ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ัะตะปะธะทะฐ
- `make show-version` - ะฟะพะบะฐะทะฐัั ัะตะบัััั ะฒะตััะธั

---

## ๐ ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ัะตะปะธะทะฐ

```bash
# 1. ะะฑะฝะพะฒะธัั ะฒะตััะธั
vim plugin.json  # ะะทะผะตะฝะธัั "version": "9.2.4"

# 2. ะะฐะบะพะผะผะธัะธัั
git add plugin.json
git commit -m "Release v9.2.4"

# 3. ะะฐะฟัััะธัั ัะตะปะธะท
make trigger-release
# ะธะปะธ
git push origin main:release

# 4. ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั GitHub Actions
# 5. ะะตะปะธะท ะฟะพัะฒะธััั ะฒ https://github.com/fambear/mattermost-plugin-boards/releases
```

### ะกัะตะฝะฐัะธะน 2: ะะพะบะฐะปัะฝะฐั ัะฑะพัะบะฐ ะดะปั ัะตััะธัะพะฒะฐะฝะธั

```bash
# Linux/macOS
./scripts/build-release.sh

# Windows
.\scripts\build-release.ps1

# ะะตะทัะปััะฐั: dist/boards-{version}.tar.gz
```

### ะกัะตะฝะฐัะธะน 3: ะะฑะฝะพะฒะปะตะฝะธะต ะฝะฐ ัะตัะฒะตัะต

```bash
# ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะดะพ ะฟะพัะปะตะดะฝะตะน ะฒะตััะธะธ
sudo ./scripts/update-plugin-on-server.sh

# ะะฑะฝะพะฒะปะตะฝะธะต ะดะพ ะบะพะฝะบัะตัะฝะพะน ะฒะตััะธะธ
sudo ./scripts/update-plugin-on-server.sh 9.2.4
```

---

## ๐ ะัะพะฒะตัะบะฐ ัะตะปะธะทะฐ

### ะะตัะตะด ัะพะทะดะฐะฝะธะตะผ ัะตะปะธะทะฐ

```bash
# ะัะพะฒะตัะธัั ัะตะบัััั ะฒะตััะธั
make show-version

# ะะฐะฟัััะธัั ัะตััั
make ci

# ะะพะบะฐะปัะฝะฐั ัะฑะพัะบะฐ
make dist-linux

# ะัะพะฒะตัะธัั ััะพ ัะฐะนะป ัะพะทะดะฐะฝ
ls -lh dist/boards-*.tar.gz
```

### ะะพัะปะต ัะพะทะดะฐะฝะธั ัะตะปะธะทะฐ

1. **GitHub:**
   - ะัะพะฒะตัะธัั ััะพ ัะตะปะธะท ัะพะทะดะฐะฝ
   - ะัะพะฒะตัะธัั ััะพ ะฐััะตัะฐะบั ะทะฐะณััะถะตะฝ
   - ะัะพะฒะตัะธัั ััะพ ัะตะณ ัะพะทะดะฐะฝ

2. **ะะฐ ัะตัะฒะตัะต:**
   ```bash
   # ะัะพะฒะตัะธัั ะฒะตััะธั ะฟะปะฐะณะธะฝะฐ
   # System Console โ Plugins โ Plugin Management
   
   # ะัะพะฒะตัะธัั ะปะพะณะธ
   tail -f /opt/mattermost/logs/mattermost.log
   ```

---

## โ๏ธ ะะฐัััะพะนะบะฐ

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะธะท `.env.example`:

```bash
cp .env.example .env
```

ะัะฝะพะฒะฝัะต ะฟะตัะตะผะตะฝะฝัะต:
- `MM_DEBUG=true` - ัะฑะพัะบะฐ ัะพะปัะบะพ ะดะปั ัะตะบััะตะน ะฟะปะฐััะพัะผั
- `MM_SERVER_PATH` - ะฟััั ะบ ัะตัะฒะตัั Mattermost
- `MM_SERVICESETTINGS_SITEURL` - URL ัะตัะฒะตัะฐ

### ะะฐัััะพะนะบะฐ GitHub Actions

Workflow ะธัะฟะพะปัะทัะตั `GITHUB_TOKEN`, ะบะพัะพััะน ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะตะดะพััะฐะฒะปัะตััั GitHub Actions.

ะขัะตะฑัะตะผัะต permissions (ัะถะต ะฝะฐัััะพะตะฝั ะฒ release.yml):
```yaml
permissions:
  contents: write
```

---

## ๐ Troubleshooting

### ะะตะปะธะท ะฝะต ัะพะทะดะฐะตััั

**ะัะพะฑะปะตะผะฐ:** GitHub Actions ะฝะต ะทะฐะฟััะบะฐะตััั

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัะธัั ััะพ ะฒั ะฟััะธัะต ะฒ ะฟัะฐะฒะธะปัะฝัั ะฒะตัะบั
git branch -a

# ะัะพะฒะตัะธัั ะปะพะณะธ Actions
# GitHub โ Actions โ Release Build
```

**ะัะพะฑะปะตะผะฐ:** ะะตััะธั ะฝะตะบะพััะตะบัะฝะฐ

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัะธัั ัะพัะผะฐั ะฒะตััะธะธ ะฒ plugin.json
jq -r '.version' plugin.json
# ะะพะปะถะฝะพ ะฑััั: X.Y.Z (ะฝะฐะฟัะธะผะตั, 9.2.3)
```

### ะกะฑะพัะบะฐ ะฟะฐะดะฐะตั

**ะัะพะฑะปะตะผะฐ:** ะัะธะฑะบะธ ะบะพะผะฟะธะปััะธะธ

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัะธัั ะปะพะบะฐะปัะฝะพ
make dist-linux

# ะัะพะฒะตัะธัั ะทะฐะฒะธัะธะผะพััะธ
go mod tidy
cd webapp && npm ci
```

### ะะปะฐะณะธะฝ ะฝะต ัะฐะฑะพัะฐะตั ะฝะฐ ัะตัะฒะตัะต

**ะัะพะฑะปะตะผะฐ:** ะะปะฐะณะธะฝ ะฝะต ะทะฐะณััะถะฐะตััั

**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัะธัั ะปะพะณะธ
journalctl -u mattermost -n 100

# ะัะพะฒะตัะธัั ะฟัะฐะฒะฐ
ls -la /opt/mattermost/plugins/boards
chown -R mattermost:mattermost /opt/mattermost/plugins/boards

# ะัะพะฒะตัะธัั ะฒะตััะธั Mattermost
# ะะธะฝะธะผะฐะปัะฝะฐั ะฒะตััะธั ัะบะฐะทะฐะฝะฐ ะฒ plugin.json: "min_server_version"
```

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Mattermost Plugin Documentation](https://developers.mattermost.com/integrate/plugins/)
- [Makefile Tutorial](https://makefiletutorial.com/)

